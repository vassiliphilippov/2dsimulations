<html>
<head>
  <title>Test 8: Proximity events</title>
  <script src="../matter.js"></script>
  <script src="../force.js"></script>
  <script src="../zonemap.js"></script>
  <script src="../background.js"></script>
  <script src="../debug.js"></script>
  <script src="../chemistryparticles.json"></script>
  <script src="../chemistrycompoundstructures.js"></script>
  <script src="../atomcolors.json"></script>
  <script src="../periodictable.json"></script>
  <script src="../chemistry.js"></script>
  <script src="../particles.js"></script>
  <script src="../temperature.js"></script>
  <script src="../proximity.js"></script>
  <script src="../chemistryrender.js"></script>
</head>
<body>
<script>

var engine = null;

ZoneMap.load("map8.png", function (zoneMap) {
    engine = Matter.Engine.create();
    var render = ChemistryRender.create({element: document.body, engine: engine, options: {width: zoneMap.width, height: zoneMap.height}});
    Matter.World.add(engine.world, Chemistry.createMappedBodies(zoneMap));

    engine.world.gravity.y = 0;
    new ParticleList(engine).setTemperature(50);
    new ParticleList(engine).setOptions({plugin: {proximity: {levels: [10, 50]}}});

    Matter.Events.on(engine, "comeClose", event => {
        let bodyA = event.bodyA;
        let bodyB = event.bodyB;
        document.getElementById("lastevent").innerHTML = "Last event: comeClose " + bodyA.label + " - " + bodyB.label + " Level: " + event.level + " Distance " + event.distance;
    });

    Matter.Events.on(engine, "goAway", event => {
        let bodyA = event.bodyA;
        let bodyB = event.bodyB;
        document.getElementById("lastevent").innerHTML = "Last event: goAway " + bodyA.label + " - " + bodyB.label + " Level: " + event.level + " Distance " + event.distance;
    });

    Debug.init(engine);
    Force.init(engine);
    Temperature.init(engine);
    Proximity.init(engine);

    Matter.Engine.run(engine);
    ChemistryRender.run(render);
});

</script>
<p id="lastevent"></p>
</body>
</html>